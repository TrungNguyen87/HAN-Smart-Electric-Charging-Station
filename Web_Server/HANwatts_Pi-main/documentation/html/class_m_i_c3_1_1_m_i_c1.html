<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Raspberry Pi software: MIC3.MIC1 Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Raspberry Pi software
   &#160;<span id="projectnumber">2.0</span>
   </div>
   <div id="projectbrief">Scripts and libraries used by the Raspberry Pi</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('class_m_i_c3_1_1_m_i_c1.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="class_m_i_c3_1_1_m_i_c1-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">MIC3.MIC1 Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Class for reading Modbus data from <a class="el" href="class_m_i_c3_1_1_m_i_c1.html" title="Class for reading Modbus data from MIC1 energy meter. ">MIC1</a> energy meter.  
 <a href="class_m_i_c3_1_1_m_i_c1.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a4da84973f93568b4d4434906a2290d39"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#a4da84973f93568b4d4434906a2290d39">__init__</a> (self, Id, Control)</td></tr>
<tr class="separator:a4da84973f93568b4d4434906a2290d39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a452c39aafd6a6091eb4a6d1f96cfc159"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#a452c39aafd6a6091eb4a6d1f96cfc159">readPT1</a> (self)</td></tr>
<tr class="memdesc:a452c39aafd6a6091eb4a6d1f96cfc159"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads PT1 variable needed for all other calculations.  <a href="#a452c39aafd6a6091eb4a6d1f96cfc159">More...</a><br /></td></tr>
<tr class="separator:a452c39aafd6a6091eb4a6d1f96cfc159"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a965d6b2d1f557741c6361814f7b7be3f"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#a965d6b2d1f557741c6361814f7b7be3f">readPT2</a> (self)</td></tr>
<tr class="memdesc:a965d6b2d1f557741c6361814f7b7be3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads PT2 variable needed for all other calculations.  <a href="#a965d6b2d1f557741c6361814f7b7be3f">More...</a><br /></td></tr>
<tr class="separator:a965d6b2d1f557741c6361814f7b7be3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09827187550f80e18fae9d5684925dae"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#a09827187550f80e18fae9d5684925dae">readCT1</a> (self)</td></tr>
<tr class="memdesc:a09827187550f80e18fae9d5684925dae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads CT1 variable needed for all other calculations.  <a href="#a09827187550f80e18fae9d5684925dae">More...</a><br /></td></tr>
<tr class="separator:a09827187550f80e18fae9d5684925dae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a192d8b14144c07ce83081d88541432"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#a8a192d8b14144c07ce83081d88541432">readPhaseVoltage</a> (self)</td></tr>
<tr class="memdesc:a8a192d8b14144c07ce83081d88541432"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads and calculates phase Voltages with the help of PT1 and PT2.  <a href="#a8a192d8b14144c07ce83081d88541432">More...</a><br /></td></tr>
<tr class="separator:a8a192d8b14144c07ce83081d88541432"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0972a5f5492a0c9845d28063214a1882"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#a0972a5f5492a0c9845d28063214a1882">readPhaseCurrent</a> (self)</td></tr>
<tr class="memdesc:a0972a5f5492a0c9845d28063214a1882"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads and calculates phase Currents with the help of CT1.  <a href="#a0972a5f5492a0c9845d28063214a1882">More...</a><br /></td></tr>
<tr class="separator:a0972a5f5492a0c9845d28063214a1882"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cb7738a71fa4b3782ad6df585ed288a"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#a2cb7738a71fa4b3782ad6df585ed288a">readPhasePower</a> (self)</td></tr>
<tr class="memdesc:a2cb7738a71fa4b3782ad6df585ed288a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads and calculates phase Power values with the help of PT1, PT2, CT1.  <a href="#a2cb7738a71fa4b3782ad6df585ed288a">More...</a><br /></td></tr>
<tr class="separator:a2cb7738a71fa4b3782ad6df585ed288a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d7c0913d3999f6f7737d6ffc56383a3"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#a8d7c0913d3999f6f7737d6ffc56383a3">readReactivePower</a> (self)</td></tr>
<tr class="memdesc:a8d7c0913d3999f6f7737d6ffc56383a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads and calculates Reactive Power (Q) values with the help of PT1, PT2, CT1.  <a href="#a8d7c0913d3999f6f7737d6ffc56383a3">More...</a><br /></td></tr>
<tr class="separator:a8d7c0913d3999f6f7737d6ffc56383a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dfae003c1d98bdda449416f6108926e"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#a1dfae003c1d98bdda449416f6108926e">readApparentPower</a> (self)</td></tr>
<tr class="memdesc:a1dfae003c1d98bdda449416f6108926e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads and calculates Apparent Power (S) values with the help of PT1, PT2, CT1 This function is diferent because the CRC value overflows and is to be edited to not error.  <a href="#a1dfae003c1d98bdda449416f6108926e">More...</a><br /></td></tr>
<tr class="separator:a1dfae003c1d98bdda449416f6108926e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd04a6d0187293021a5f4f7d853ea447"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#afd04a6d0187293021a5f4f7d853ea447">readPowerFactor</a> (self)</td></tr>
<tr class="memdesc:afd04a6d0187293021a5f4f7d853ea447"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads and calculates Power Factors (PF)  <a href="#afd04a6d0187293021a5f4f7d853ea447">More...</a><br /></td></tr>
<tr class="separator:afd04a6d0187293021a5f4f7d853ea447"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a72cfbf9d28d2810fd45c5ea3158f5d"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#a4a72cfbf9d28d2810fd45c5ea3158f5d">readFrequency</a> (self)</td></tr>
<tr class="memdesc:a4a72cfbf9d28d2810fd45c5ea3158f5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads and calculates Frequency (F)  <a href="#a4a72cfbf9d28d2810fd45c5ea3158f5d">More...</a><br /></td></tr>
<tr class="separator:a4a72cfbf9d28d2810fd45c5ea3158f5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a925ca2e301860fe9aa378350534b161f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#a925ca2e301860fe9aa378350534b161f">__Control</a></td></tr>
<tr class="separator:a925ca2e301860fe9aa378350534b161f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41c7912044a1237fba1a97e5c3ce7af1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#a41c7912044a1237fba1a97e5c3ce7af1">__Address</a></td></tr>
<tr class="separator:a41c7912044a1237fba1a97e5c3ce7af1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0202879a9a20c6db9fab96bf2bc2665a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#a0202879a9a20c6db9fab96bf2bc2665a">__PT1</a></td></tr>
<tr class="separator:a0202879a9a20c6db9fab96bf2bc2665a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27404fde06ca91ba97fed1afe1305a4c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#a27404fde06ca91ba97fed1afe1305a4c">__PT2</a></td></tr>
<tr class="separator:a27404fde06ca91ba97fed1afe1305a4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa1e6791e5fb9881e4c0bb7fdba94a1f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#aaa1e6791e5fb9881e4c0bb7fdba94a1f">__CT1</a></td></tr>
<tr class="separator:aaa1e6791e5fb9881e4c0bb7fdba94a1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a808ae0455f68a6e35d5cf646f2ed5bed"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#a808ae0455f68a6e35d5cf646f2ed5bed">__V1</a></td></tr>
<tr class="separator:a808ae0455f68a6e35d5cf646f2ed5bed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa931212b1077630e0d00a7521b9ba7ef"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#aa931212b1077630e0d00a7521b9ba7ef">__V2</a></td></tr>
<tr class="separator:aa931212b1077630e0d00a7521b9ba7ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac14c988b04364214b6846226e31d7416"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#ac14c988b04364214b6846226e31d7416">__V3</a></td></tr>
<tr class="separator:ac14c988b04364214b6846226e31d7416"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9c7409f828f138464d9a3993b5f963e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#aa9c7409f828f138464d9a3993b5f963e">__I1</a></td></tr>
<tr class="separator:aa9c7409f828f138464d9a3993b5f963e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17b42cbaf99e99320ef96d929239cf44"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#a17b42cbaf99e99320ef96d929239cf44">__I2</a></td></tr>
<tr class="separator:a17b42cbaf99e99320ef96d929239cf44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada54499b12ef8714e2e359d69a5a9a37"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#ada54499b12ef8714e2e359d69a5a9a37">__I3</a></td></tr>
<tr class="separator:ada54499b12ef8714e2e359d69a5a9a37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9d7c288a2f535a91f01fdb7f688f9cc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#ad9d7c288a2f535a91f01fdb7f688f9cc">__P1</a></td></tr>
<tr class="separator:ad9d7c288a2f535a91f01fdb7f688f9cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4bbfbf696790ea59be3e8153089107e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#ac4bbfbf696790ea59be3e8153089107e">__P2</a></td></tr>
<tr class="separator:ac4bbfbf696790ea59be3e8153089107e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a584aaa23ae37f473e718ac005c95be6e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#a584aaa23ae37f473e718ac005c95be6e">__P3</a></td></tr>
<tr class="separator:a584aaa23ae37f473e718ac005c95be6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accfdf53475991f816e00e89be6011df5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#accfdf53475991f816e00e89be6011df5">__Q1</a></td></tr>
<tr class="separator:accfdf53475991f816e00e89be6011df5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa52fd24601379190142365d2e94ed3bc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#aa52fd24601379190142365d2e94ed3bc">__Q2</a></td></tr>
<tr class="separator:aa52fd24601379190142365d2e94ed3bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcffecd5fd8a2b410326e3d5ba79c78e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#afcffecd5fd8a2b410326e3d5ba79c78e">__Q3</a></td></tr>
<tr class="separator:afcffecd5fd8a2b410326e3d5ba79c78e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bcbbf706089333c946aa4965af8e656"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#a6bcbbf706089333c946aa4965af8e656">__S1</a></td></tr>
<tr class="separator:a6bcbbf706089333c946aa4965af8e656"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab89d273cd8a7d1f0fe67a701e9e54f82"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#ab89d273cd8a7d1f0fe67a701e9e54f82">__S2</a></td></tr>
<tr class="separator:ab89d273cd8a7d1f0fe67a701e9e54f82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5f14575962daa8e627bc9fdf673b253"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#af5f14575962daa8e627bc9fdf673b253">__S3</a></td></tr>
<tr class="separator:af5f14575962daa8e627bc9fdf673b253"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2eb1458e0c349707753186002063859b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#a2eb1458e0c349707753186002063859b">__PF1</a></td></tr>
<tr class="separator:a2eb1458e0c349707753186002063859b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bd93a47ffd2e1440f00ea82e1b26f65"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#a6bd93a47ffd2e1440f00ea82e1b26f65">__PF2</a></td></tr>
<tr class="separator:a6bd93a47ffd2e1440f00ea82e1b26f65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cedb48c21b85171b2f8f316afa59a85"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#a0cedb48c21b85171b2f8f316afa59a85">__PF3</a></td></tr>
<tr class="separator:a0cedb48c21b85171b2f8f316afa59a85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac24e1bb43a234d3545bd9dea897ee7f8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html#ac24e1bb43a234d3545bd9dea897ee7f8">__F</a></td></tr>
<tr class="separator:ac24e1bb43a234d3545bd9dea897ee7f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class for reading Modbus data from <a class="el" href="class_m_i_c3_1_1_m_i_c1.html" title="Class for reading Modbus data from MIC1 energy meter. ">MIC1</a> energy meter. </p>

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00248">248</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a4da84973f93568b4d4434906a2290d39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4da84973f93568b4d4434906a2290d39">&#9670;&nbsp;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def MIC3.MIC1.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Control</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00249">249</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keyword">def </span>__init__(self, Id, Control):</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        self.__Control = Control</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        self.__Address = Id</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        self.__PT1 = 1.0</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        self.__PT2 = 1.0</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        self.__CT1 = 1.0</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        self.__V1 = 0.0</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        self.__V2 = 0.0</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        self.__V3 = 0.0</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        self.__I1 = 0.0</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        self.__I2 = 0.0</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        self.__I3 = 0.0</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        self.__P1 = 0.0</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        self.__P2 = 0.0</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        self.__P3 = 0.0</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        self.__Q1 = 0.0</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        self.__Q2 = 0.0</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        self.__Q3 = 0.0</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        self.__S1 = 0.0</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        self.__S2 = 0.0</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        self.__S3 = 0.0</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        self.__PF1 = 0.0</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        self.__PF2 = 0.0</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        self.__PF3 = 0.0</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        self.__F  = 0.0</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    </div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a1dfae003c1d98bdda449416f6108926e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dfae003c1d98bdda449416f6108926e">&#9670;&nbsp;</a></span>readApparentPower()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def MIC3.MIC1.readApparentPower </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads and calculates Apparent Power (S) values with the help of PT1, PT2, CT1 This function is diferent because the CRC value overflows and is to be edited to not error. </p>

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00709">709</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">References <a class="el" href="_m_i_c3_8py_source.html#l00028">MIC3.MIC2.__Address</a>, <a class="el" href="_m_i_c3_8py_source.html#l00251">MIC3.MIC1.__Address</a>, <a class="el" href="_m_i_c3_8py_source.html#l00027">MIC3.MIC2.__Control</a>, <a class="el" href="_m_i_c3_8py_source.html#l00250">MIC3.MIC1.__Control</a>, <a class="el" href="_m_i_c3_8py_source.html#l00254">MIC3.MIC1.__CT1</a>, <a class="el" href="_m_i_c3_8py_source.html#l00252">MIC3.MIC1.__PT1</a>, <a class="el" href="_m_i_c3_8py_source.html#l00253">MIC3.MIC1.__PT2</a>, <a class="el" href="_m_i_c3_8py_source.html#l00267">MIC3.MIC1.__S1</a>, <a class="el" href="_m_i_c3_8py_source.html#l00268">MIC3.MIC1.__S2</a>, and <a class="el" href="_m_i_c3_8py_source.html#l00269">MIC3.MIC1.__S3</a>.</p>
<div class="fragment"><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="keyword">def </span>readApparentPower(self):</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        <span class="comment">#Calculate CRC16-MODBUS</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        crc16 = crcmod.mkCrcFun(0x18005, rev=<span class="keyword">True</span>, initCrc = 0xFFFF, xorOut = 0x0000)</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        crc_Tx = <span class="stringliteral">&quot;.%4x&quot;</span>%(crc16(serial.to_bytes([self.__Address, 0x03, 0x01, 0x46, 0x00, 0x03])))</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        crc_Tx = crc_Tx.replace(<span class="stringliteral">&quot; &quot;</span>, <span class="stringliteral">&quot;0&quot;</span>)</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <span class="comment">#The crc_Tx must include 4 hexadecimal characters.</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="comment">#If crc_Tx = 10, function hex() will return 0xa, which is not expected</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <span class="comment">#Therefore, String format operator was used</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    </div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        <span class="comment">#Send request</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        GPIO.output(self.__Control, GPIO.HIGH)</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        ser.write(serial.to_bytes([self.__Address, 0x03, 0x01, 0x46, 0x00, 0x03, int(crc_Tx[3:],16), int(crc_Tx[1:3],16)]))</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        </div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="comment">#There is a delay caused by the converter. The program must wait before reading the result</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        sleep(0.02)</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    </div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <span class="comment">#Receive data</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        GPIO.output(self.__Control, GPIO.LOW)</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        cnt = 0</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        data_left = ser.inWaiting()</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <span class="keywordflow">while</span> (data_left == 0):</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            <span class="comment">#wait for data</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            cnt=cnt+1</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            <span class="keywordflow">if</span> (cnt &lt; 50000): <span class="comment">#wait for maximum 5 seconds</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                sleep(0.0001)</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                data_left = ser.inWaiting()</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                print(<span class="stringliteral">&quot;Transmitting error: Time out&quot;</span>)</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                <span class="keywordflow">return</span> Trans_error</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        received_data = ser.read()</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        sleep(0.02)</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        data_left = ser.inWaiting()</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        received_data += ser.read(data_left)</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        </div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <span class="keywordflow">if</span> ((received_data[0]) != self.__Address):</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Data corrupted&quot;</span>)</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            <span class="keywordflow">return</span> Data_error</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        <span class="keywordflow">if</span> (len(received_data) != 11):</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Data corrupted&quot;</span>)</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            <span class="keywordflow">return</span> Data_error</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        </div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        <span class="comment">#Check the CRC code</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        crc_cal = hex(crc16(received_data[:9]))</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        crc_Rx = hex(struct.unpack(<span class="stringliteral">&#39;H&#39;</span>,received_data[9:])[0])</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    </div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        <span class="keywordflow">if</span> crc_cal == crc_Rx:</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            self.__S1 = float(struct.unpack(<span class="stringliteral">&#39;H&#39;</span>, received_data[4:2:-1])[0])*(self.__PT1/self.__PT2)*(self.__CT1/5)</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            self.__S2 = float(struct.unpack(<span class="stringliteral">&#39;H&#39;</span>, received_data[6:4:-1])[0])*(self.__PT1/self.__PT2)*(self.__CT1/5)</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            self.__S3 = float(struct.unpack(<span class="stringliteral">&#39;H&#39;</span>, received_data[8:6:-1])[0])*(self.__PT1/self.__PT2)*(self.__CT1/5)    </div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            <span class="keywordflow">return</span> No_error</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Incorrect CRC&quot;</span>)</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            <span class="keywordflow">return</span> CRC_error</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    </div></div><!-- fragment -->
</div>
</div>
<a id="a09827187550f80e18fae9d5684925dae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09827187550f80e18fae9d5684925dae">&#9670;&nbsp;</a></span>readCT1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def MIC3.MIC1.readCT1 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads CT1 variable needed for all other calculations. </p>

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00410">410</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">References <a class="el" href="_m_i_c3_8py_source.html#l00028">MIC3.MIC2.__Address</a>, <a class="el" href="_m_i_c3_8py_source.html#l00251">MIC3.MIC1.__Address</a>, <a class="el" href="_m_i_c3_8py_source.html#l00027">MIC3.MIC2.__Control</a>, <a class="el" href="_m_i_c3_8py_source.html#l00250">MIC3.MIC1.__Control</a>, and <a class="el" href="_m_i_c3_8py_source.html#l00254">MIC3.MIC1.__CT1</a>.</p>
<div class="fragment"><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keyword">def </span>readCT1(self):</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="comment">#Calculate CRC16-MODBUS</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        crc16 = crcmod.mkCrcFun(0x18005, rev=<span class="keyword">True</span>, initCrc = 0xFFFF, xorOut = 0x0000)</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        crc_Tx = <span class="stringliteral">&quot;.%4x&quot;</span>%(crc16(serial.to_bytes([self.__Address, 0x03, 0x01, 0x08, 0x00, 0x01])))</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="comment">#The crc_Tx must include 4 hexadecimal characters.</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <span class="comment">#If crc_Tx =  10, function hex() will return 0xa, which is not expected</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <span class="comment">#Therefore, String format operator was used</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    </div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="comment">#Send request</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        GPIO.output(self.__Control, GPIO.HIGH)</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        ser.write(serial.to_bytes([self.__Address, 0x03, 0x01, 0x08, 0x00, 0x01, int(crc_Tx[3:],16), int(crc_Tx[1:3],16)]))</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    </div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="comment">#There is a delay caused by the converter. The program must wait before reading the result</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        sleep(0.01)</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    </div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="comment">#Receive data</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        GPIO.output(self.__Control, GPIO.LOW)</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        cnt = 0</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        data_left = ser.inWaiting()</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordflow">while</span> (data_left == 0):</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            <span class="comment">#wait for data</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            cnt=cnt+1</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <span class="keywordflow">if</span> (cnt &lt; 50000): <span class="comment">#wait for maximum 5 seconds</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                sleep(0.0001)</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                data_left = ser.inWaiting()</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                print(<span class="stringliteral">&quot;Transmitting error: Time out&quot;</span>)</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                <span class="keywordflow">return</span> Trans_error</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    </div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        received_data = ser.read()</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        sleep(0.01)</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        data_left = ser.inWaiting()</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        received_data += ser.read(data_left)</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        </div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <span class="comment">#Check if the data is correct</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="keywordflow">if</span> ((received_data[0]) != self.__Address):</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Data corrupted&quot;</span>)</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            <span class="keywordflow">return</span> Data_error</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="keywordflow">if</span> (len(received_data) != 7):</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Data corrupted&quot;</span>)</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            <span class="keywordflow">return</span> Data_error</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        </div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="comment">#Check the CRC code</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        crc_cal = hex(crc16(received_data[:5]))</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="comment">#DEBUG ONLY-----------------------------------------------</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="comment">#retval = &quot;&quot;</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="comment">#for character in received_data:</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="comment">#    retval += (&#39;0123456789ABCDEF&#39;[int((character)/16)])</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <span class="comment">#    retval += (&#39;0123456789ABCDEF&#39;[int((character)%16)])</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="comment">#    retval += &#39;:&#39;</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="comment">#print (retval[:-1])</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="comment">#print (crc_cal) #use for debugging only</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="comment">#---------------------------------------------------------</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    </div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        crc_Rx = hex(struct.unpack(<span class="stringliteral">&#39;H&#39;</span>,received_data[5:])[0])</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    </div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="comment">#print (crc_Rx) #use for degugging only</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    </div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <span class="keywordflow">if</span> crc_cal == crc_Rx:</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            self.__CT1 = float(struct.unpack(<span class="stringliteral">&#39;H&#39;</span>, received_data[4:2:-1])[0])</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            <span class="keywordflow">return</span> No_error</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Incorrect CRC&quot;</span>)</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            <span class="keywordflow">return</span> CRC_error</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    </div></div><!-- fragment -->
</div>
</div>
<a id="a4a72cfbf9d28d2810fd45c5ea3158f5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a72cfbf9d28d2810fd45c5ea3158f5d">&#9670;&nbsp;</a></span>readFrequency()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def MIC3.MIC1.readFrequency </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads and calculates Frequency (F) </p>

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00818">818</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">References <a class="el" href="_m_i_c3_8py_source.html#l00028">MIC3.MIC2.__Address</a>, <a class="el" href="_m_i_c3_8py_source.html#l00251">MIC3.MIC1.__Address</a>, <a class="el" href="_m_i_c3_8py_source.html#l00027">MIC3.MIC2.__Control</a>, <a class="el" href="_m_i_c3_8py_source.html#l00250">MIC3.MIC1.__Control</a>, <a class="el" href="_m_i_c3_8py_source.html#l00038">MIC3.MIC2.__F</a>, and <a class="el" href="_m_i_c3_8py_source.html#l00273">MIC3.MIC1.__F</a>.</p>
<div class="fragment"><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="keyword">def </span>readFrequency(self):</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <span class="comment">#Calculate CRC16-MODBUS</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        crc16 = crcmod.mkCrcFun(0x18005, rev=<span class="keyword">True</span>, initCrc = 0xFFFF, xorOut = 0x0000)</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        crc_Tx = <span class="stringliteral">&quot;.%4x&quot;</span>%(crc16(serial.to_bytes([self.__Address, 0x03, 0x01, 0x30, 0x00, 0x01])))</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <span class="comment">#The crc_Tx must include 4 hexadecimal characters.</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <span class="comment">#If crc_Tx =  10, function hex() will return 0xa, which is not expected</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        <span class="comment">#Therefore, String format operator was used</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    </div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        <span class="comment">#Send request</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        GPIO.output(self.__Control, GPIO.HIGH)</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        ser.write(serial.to_bytes([self.__Address, 0x03, 0x01, 0x30, 0x00, 0x01, int(crc_Tx[3:],16), int(crc_Tx[1:3],16)]))</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    </div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <span class="comment">#There is a delay caused by the converter. The program must wait before reading the result</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        sleep(0.01)</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    </div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        <span class="comment">#Receive data</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        GPIO.output(self.__Control, GPIO.LOW)</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        cnt = 0</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        data_left = ser.inWaiting()</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <span class="keywordflow">while</span> (data_left == 0):</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            <span class="comment">#wait for data</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            cnt=cnt+1</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            <span class="keywordflow">if</span> (cnt &lt; 50000): <span class="comment">#wait for maximum 5 seconds</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                sleep(0.0001)</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                data_left = ser.inWaiting()</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                print(<span class="stringliteral">&quot;Transmitting error: Time out&quot;</span>)</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                <span class="keywordflow">return</span> Trans_error</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        received_data = ser.read()</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        sleep(0.01)</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        data_left = ser.inWaiting()</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        received_data += ser.read(data_left)</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        </div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <span class="comment">#DEBUG ONLY-----------------------------------------------</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        <span class="comment">#retval = &quot;&quot;</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        <span class="comment">#for character in received_data:</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        <span class="comment">#    retval += (&#39;0123456789ABCDEF&#39;[int((character)/16)])</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        <span class="comment">#    retval += (&#39;0123456789ABCDEF&#39;[int((character)%16)])</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        <span class="comment">#    retval += &#39;:&#39;</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <span class="comment">#print (retval[:-1])</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        <span class="comment">#print (crc_cal) #use for debugging only</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        <span class="comment">#---------------------------------------------------------</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        <span class="keywordflow">if</span> ((received_data[0]) != self.__Address):</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Data corrupted&quot;</span>)</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            <span class="keywordflow">return</span> Data_error</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        <span class="keywordflow">if</span> (len(received_data) != 7):</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Data corrupted&quot;</span>)</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            <span class="keywordflow">return</span> Data_error</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    </div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <span class="comment">#Check the CRC code</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        crc_cal = hex(crc16(received_data[:5]))</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        crc_Rx = hex(struct.unpack(<span class="stringliteral">&#39;H&#39;</span>,received_data[5:])[0])</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        </div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <span class="keywordflow">if</span> crc_cal == crc_Rx:</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            self.__F = float(struct.unpack(<span class="stringliteral">&#39;H&#39;</span>, received_data[4:2:-1])[0])/100    </div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            <span class="keywordflow">return</span> No_error</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Incorrect CRC&quot;</span>)</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;            <span class="keywordflow">return</span> CRC_error</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment">#---------------------------------END OF MIC1------------------------------------</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">#--------------------------------------------------------------------------------</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div><!-- fragment -->
</div>
</div>
<a id="a0972a5f5492a0c9845d28063214a1882"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0972a5f5492a0c9845d28063214a1882">&#9670;&nbsp;</a></span>readPhaseCurrent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def MIC3.MIC1.readPhaseCurrent </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads and calculates phase Currents with the help of CT1. </p>

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00546">546</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">References <a class="el" href="_m_i_c3_8py_source.html#l00028">MIC3.MIC2.__Address</a>, <a class="el" href="_m_i_c3_8py_source.html#l00251">MIC3.MIC1.__Address</a>, <a class="el" href="_m_i_c3_8py_source.html#l00027">MIC3.MIC2.__Control</a>, <a class="el" href="_m_i_c3_8py_source.html#l00250">MIC3.MIC1.__Control</a>, <a class="el" href="_m_i_c3_8py_source.html#l00254">MIC3.MIC1.__CT1</a>, <a class="el" href="_m_i_c3_8py_source.html#l00032">MIC3.MIC2.__I1</a>, <a class="el" href="_m_i_c3_8py_source.html#l00258">MIC3.MIC1.__I1</a>, <a class="el" href="_m_i_c3_8py_source.html#l00033">MIC3.MIC2.__I2</a>, <a class="el" href="_m_i_c3_8py_source.html#l00259">MIC3.MIC1.__I2</a>, <a class="el" href="_m_i_c3_8py_source.html#l00034">MIC3.MIC2.__I3</a>, and <a class="el" href="_m_i_c3_8py_source.html#l00260">MIC3.MIC1.__I3</a>.</p>
<div class="fragment"><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keyword">def </span>readPhaseCurrent(self):</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <span class="comment">#Calculate CRC16-MODBUS</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        crc16 = crcmod.mkCrcFun(0x18005, rev=<span class="keyword">True</span>, initCrc = 0xFFFF, xorOut = 0x0000)</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        crc_Tx = <span class="stringliteral">&quot;.%4x&quot;</span>%(crc16(serial.to_bytes([self.__Address, 0x03, 0x01, 0x39, 0x00, 0x03])))</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="comment">#The crc_Tx must include 4 hexadecimal characters.</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="comment">#If crc_Tx =  10, function hex() will return 0xa, which is not expected</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <span class="comment">#Therefore, String format operator was used</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    </div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <span class="comment">#Send request</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        GPIO.output(self.__Control, GPIO.HIGH)</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        ser.write(serial.to_bytes([self.__Address, 0x03, 0x01, 0x39, 0x00, 0x03, int(crc_Tx[3:],16), int(crc_Tx[1:3],16)]))</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    </div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="comment">#There is a delay caused by the converter. The program must wait before reading the result</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        sleep(0.01)</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    </div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="comment">#Receive data</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        GPIO.output(self.__Control, GPIO.LOW)</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        cnt = 0</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        data_left = ser.inWaiting()</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <span class="keywordflow">while</span> (data_left == 0):</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            <span class="comment">#wait for data</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            cnt=cnt+1</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            <span class="keywordflow">if</span> (cnt &lt; 50000): <span class="comment">#wait for maximum 5 seconds</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                sleep(0.0001)</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                data_left = ser.inWaiting()</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                print(<span class="stringliteral">&quot;Transmitting error: Time out&quot;</span>)</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                <span class="keywordflow">return</span> Trans_error</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        received_data = ser.read()</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        sleep(0.01)</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        data_left = ser.inWaiting()</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        received_data += ser.read(data_left)</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        </div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="keywordflow">if</span> ((received_data[0]) != self.__Address):</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Data corrupted&quot;</span>)</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            <span class="keywordflow">return</span> Data_error</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <span class="keywordflow">if</span> (len(received_data) != 11):</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Data corrupted&quot;</span>)</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            <span class="keywordflow">return</span> Data_error</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    </div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <span class="comment">#Check the CRC code</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        crc_cal = hex(crc16(received_data[:9]))</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        crc_Rx = hex(struct.unpack(<span class="stringliteral">&#39;H&#39;</span>,received_data[9:])[0])</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    </div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="keywordflow">if</span> crc_cal == crc_Rx:</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            self.__I1 = float(struct.unpack(<span class="stringliteral">&#39;H&#39;</span>, received_data[4:2:-1])[0])*(self.__CT1/5)/1000</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            self.__I2 = float(struct.unpack(<span class="stringliteral">&#39;H&#39;</span>, received_data[6:4:-1])[0])*(self.__CT1/5)/1000</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            self.__I3 = float(struct.unpack(<span class="stringliteral">&#39;H&#39;</span>, received_data[8:6:-1])[0])*(self.__CT1/5)/1000   </div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            <span class="keywordflow">return</span> No_error</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Incorrect CRC&quot;</span>)</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            <span class="keywordflow">return</span> CRC_error</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            </div></div><!-- fragment -->
</div>
</div>
<a id="a2cb7738a71fa4b3782ad6df585ed288a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cb7738a71fa4b3782ad6df585ed288a">&#9670;&nbsp;</a></span>readPhasePower()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def MIC3.MIC1.readPhasePower </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads and calculates phase Power values with the help of PT1, PT2, CT1. </p>

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00600">600</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">References <a class="el" href="_m_i_c3_8py_source.html#l00028">MIC3.MIC2.__Address</a>, <a class="el" href="_m_i_c3_8py_source.html#l00251">MIC3.MIC1.__Address</a>, <a class="el" href="_m_i_c3_8py_source.html#l00027">MIC3.MIC2.__Control</a>, <a class="el" href="_m_i_c3_8py_source.html#l00250">MIC3.MIC1.__Control</a>, <a class="el" href="_m_i_c3_8py_source.html#l00254">MIC3.MIC1.__CT1</a>, <a class="el" href="_m_i_c3_8py_source.html#l00035">MIC3.MIC2.__P1</a>, <a class="el" href="_m_i_c3_8py_source.html#l00261">MIC3.MIC1.__P1</a>, <a class="el" href="_m_i_c3_8py_source.html#l00036">MIC3.MIC2.__P2</a>, <a class="el" href="_m_i_c3_8py_source.html#l00262">MIC3.MIC1.__P2</a>, <a class="el" href="_m_i_c3_8py_source.html#l00037">MIC3.MIC2.__P3</a>, <a class="el" href="_m_i_c3_8py_source.html#l00263">MIC3.MIC1.__P3</a>, <a class="el" href="_m_i_c3_8py_source.html#l00252">MIC3.MIC1.__PT1</a>, and <a class="el" href="_m_i_c3_8py_source.html#l00253">MIC3.MIC1.__PT2</a>.</p>
<div class="fragment"><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keyword">def </span>readPhasePower(self):</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="comment">#Calculate CRC16-MODBUS</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        crc16 = crcmod.mkCrcFun(0x18005, rev=<span class="keyword">True</span>, initCrc = 0xFFFF, xorOut = 0x0000)</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        crc_Tx = <span class="stringliteral">&quot;.%4x&quot;</span>%(crc16(serial.to_bytes([self.__Address, 0x03, 0x01, 0x3E, 0x00, 0x03])))</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        <span class="comment">#The crc_Tx must include 4 hexadecimal characters.</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <span class="comment">#If crc_Tx =  10, function hex() will return 0xa, which is not expected</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="comment">#Therefore, String format operator was used</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    </div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="comment">#Send request</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        GPIO.output(self.__Control, GPIO.HIGH)</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        ser.write(serial.to_bytes([self.__Address, 0x03, 0x01, 0x3E, 0x00, 0x03, int(crc_Tx[3:],16), int(crc_Tx[1:3],16)]))</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    </div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <span class="comment">#There is a delay caused by the converter. The program must wait before reading the result</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        sleep(0.01)</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    </div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="comment">#Receive data</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        GPIO.output(self.__Control, GPIO.LOW)</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        cnt = 0</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        data_left = ser.inWaiting()</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        <span class="keywordflow">while</span> (data_left == 0):</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            <span class="comment">#wait for data</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            cnt=cnt+1</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            <span class="keywordflow">if</span> (cnt &lt; 50000): <span class="comment">#wait for maximum 5 seconds</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                sleep(0.0001)</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                data_left = ser.inWaiting()</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                print(<span class="stringliteral">&quot;Transmitting error: Time out&quot;</span>)</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                <span class="keywordflow">return</span> Trans_error</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        received_data = ser.read()</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        sleep(0.01)</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        data_left = ser.inWaiting()</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        received_data += ser.read(data_left)</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        </div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <span class="keywordflow">if</span> ((received_data[0]) != self.__Address):</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Data corrupted&quot;</span>)</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            <span class="keywordflow">return</span> Data_error</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <span class="keywordflow">if</span> (len(received_data) != 11):</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Data corrupted&quot;</span>)</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;            <span class="keywordflow">return</span> Data_error</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        </div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="comment">#Check the CRC code</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        crc_cal = hex(crc16(received_data[:9]))</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        crc_Rx = hex(struct.unpack(<span class="stringliteral">&#39;H&#39;</span>,received_data[9:])[0])</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    </div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="keywordflow">if</span> crc_cal == crc_Rx:</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            self.__P1 = float(struct.unpack(<span class="stringliteral">&#39;h&#39;</span>, received_data[4:2:-1])[0])*(self.__PT1/self.__PT2)*(self.__CT1/5)</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            self.__P2 = float(struct.unpack(<span class="stringliteral">&#39;h&#39;</span>, received_data[6:4:-1])[0])*(self.__PT1/self.__PT2)*(self.__CT1/5)</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            self.__P3 = float(struct.unpack(<span class="stringliteral">&#39;h&#39;</span>, received_data[8:6:-1])[0])*(self.__PT1/self.__PT2)*(self.__CT1/5)    </div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            <span class="keywordflow">return</span> No_error</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Incorrect CRC&quot;</span>)</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            <span class="keywordflow">return</span> CRC_error</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a8a192d8b14144c07ce83081d88541432"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a192d8b14144c07ce83081d88541432">&#9670;&nbsp;</a></span>readPhaseVoltage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def MIC3.MIC1.readPhaseVoltage </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads and calculates phase Voltages with the help of PT1 and PT2. </p>

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00477">477</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">References <a class="el" href="_m_i_c3_8py_source.html#l00028">MIC3.MIC2.__Address</a>, <a class="el" href="_m_i_c3_8py_source.html#l00251">MIC3.MIC1.__Address</a>, <a class="el" href="_m_i_c3_8py_source.html#l00027">MIC3.MIC2.__Control</a>, <a class="el" href="_m_i_c3_8py_source.html#l00250">MIC3.MIC1.__Control</a>, <a class="el" href="_m_i_c3_8py_source.html#l00252">MIC3.MIC1.__PT1</a>, <a class="el" href="_m_i_c3_8py_source.html#l00253">MIC3.MIC1.__PT2</a>, <a class="el" href="_m_i_c3_8py_source.html#l00029">MIC3.MIC2.__V1</a>, <a class="el" href="_m_i_c3_8py_source.html#l00255">MIC3.MIC1.__V1</a>, <a class="el" href="_m_i_c3_8py_source.html#l00030">MIC3.MIC2.__V2</a>, <a class="el" href="_m_i_c3_8py_source.html#l00256">MIC3.MIC1.__V2</a>, <a class="el" href="_m_i_c3_8py_source.html#l00031">MIC3.MIC2.__V3</a>, and <a class="el" href="_m_i_c3_8py_source.html#l00257">MIC3.MIC1.__V3</a>.</p>
<div class="fragment"><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keyword">def </span>readPhaseVoltage(self):</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <span class="comment">#Calculate CRC16-MODBUS</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        crc16 = crcmod.mkCrcFun(0x18005, rev=<span class="keyword">True</span>, initCrc = 0xFFFF, xorOut = 0x0000)</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        crc_Tx = <span class="stringliteral">&quot;.%4x&quot;</span>%(crc16(serial.to_bytes([self.__Address, 0x03, 0x01, 0x31, 0x00, 0x03])))</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <span class="comment">#The crc_Tx must include 4 hexadecimal characters.</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="comment">#If crc_Tx =  10, function hex() will return 0xa, which is not expected</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <span class="comment">#Therefore, String format operator was used</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    </div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        <span class="comment">#Send request</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        GPIO.output(self.__Control, GPIO.HIGH)</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        ser.write(serial.to_bytes([self.__Address, 0x03, 0x01, 0x31, 0x00, 0x03, int(crc_Tx[3:],16), int(crc_Tx[1:3],16)]))</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    </div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="comment">#There is a delay caused by the converter. The program must wait before reading the result</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        sleep(0.01)</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    </div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="comment">#Receive data</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        GPIO.output(self.__Control, GPIO.LOW)</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        cnt = 0</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        data_left = ser.inWaiting()</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <span class="keywordflow">while</span> (data_left == 0):</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            <span class="comment">#wait for data</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            cnt=cnt+1</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            <span class="keywordflow">if</span> (cnt &lt; 50000): <span class="comment">#wait for maximum 5 seconds</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                sleep(0.0001)</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                data_left = ser.inWaiting()</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                print(<span class="stringliteral">&quot;Transmitting error: Time out&quot;</span>)</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                <span class="keywordflow">return</span> Trans_error</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    </div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        received_data = ser.read()</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        sleep(0.01)</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        data_left = ser.inWaiting()</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        received_data += ser.read(data_left)</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        </div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <span class="comment">#Check if the data is correct</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keywordflow">if</span> ((received_data[0]) != self.__Address):</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Data corrupted&quot;</span>)</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            <span class="keywordflow">return</span> Data_error</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="keywordflow">if</span> (len(received_data) != 11):</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Data corrupted&quot;</span>)</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            <span class="keywordflow">return</span> Data_error</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        </div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="comment">#Check the CRC code</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        crc_cal = hex(crc16(received_data[:9]))</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="comment">#DEBUG ONLY-----------------------------------------------</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="comment">#retval = &quot;&quot;</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <span class="comment">#for character in received_data:</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <span class="comment">#    retval += (&#39;0123456789ABCDEF&#39;[int((character)/16)])</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="comment">#    retval += (&#39;0123456789ABCDEF&#39;[int((character)%16)])</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="comment">#    retval += &#39;:&#39;</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <span class="comment">#print (retval[:-1])</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="comment">#print (crc_cal) #use for debugging only</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="comment">#---------------------------------------------------------</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    </div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        crc_Rx = hex(struct.unpack(<span class="stringliteral">&#39;H&#39;</span>,received_data[9:])[0])</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    </div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="comment">#print (crc_Rx) #use for degugging only</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    </div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <span class="keywordflow">if</span> crc_cal == crc_Rx:</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            self.__V1 = float(struct.unpack(<span class="stringliteral">&#39;H&#39;</span>, received_data[4:2:-1])[0])*(self.__PT1/self.__PT2)/10</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            self.__V2 = float(struct.unpack(<span class="stringliteral">&#39;H&#39;</span>, received_data[6:4:-1])[0])*(self.__PT1/self.__PT2)/10</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            self.__V3 = float(struct.unpack(<span class="stringliteral">&#39;H&#39;</span>, received_data[8:6:-1])[0])*(self.__PT1/self.__PT2)/10</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            <span class="keywordflow">return</span> No_error</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Incorrect CRC&quot;</span>)</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            <span class="keywordflow">return</span> CRC_error</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            </div></div><!-- fragment -->
</div>
</div>
<a id="afd04a6d0187293021a5f4f7d853ea447"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd04a6d0187293021a5f4f7d853ea447">&#9670;&nbsp;</a></span>readPowerFactor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def MIC3.MIC1.readPowerFactor </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads and calculates Power Factors (PF) </p>

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00764">764</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">References <a class="el" href="_m_i_c3_8py_source.html#l00028">MIC3.MIC2.__Address</a>, <a class="el" href="_m_i_c3_8py_source.html#l00251">MIC3.MIC1.__Address</a>, <a class="el" href="_m_i_c3_8py_source.html#l00027">MIC3.MIC2.__Control</a>, <a class="el" href="_m_i_c3_8py_source.html#l00250">MIC3.MIC1.__Control</a>, <a class="el" href="_m_i_c3_8py_source.html#l00270">MIC3.MIC1.__PF1</a>, <a class="el" href="_m_i_c3_8py_source.html#l00271">MIC3.MIC1.__PF2</a>, and <a class="el" href="_m_i_c3_8py_source.html#l00272">MIC3.MIC1.__PF3</a>.</p>
<div class="fragment"><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keyword">def </span>readPowerFactor(self):</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <span class="comment">#Calculate CRC16-MODBUS</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        crc16 = crcmod.mkCrcFun(0x18005, rev=<span class="keyword">True</span>, initCrc = 0xFFFF, xorOut = 0x0000)</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        crc_Tx = <span class="stringliteral">&quot;.%4x&quot;</span>%(crc16(serial.to_bytes([self.__Address, 0x03, 0x01, 0x4A, 0x00, 0x03])))</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        <span class="comment">#The crc_Tx must include 4 hexadecimal characters.</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <span class="comment">#If crc_Tx =  10, function hex() will return 0xa, which is not expected</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        <span class="comment">#Therefore, String format operator was used</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    </div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="comment">#Send request</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        GPIO.output(self.__Control, GPIO.HIGH)</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        ser.write(serial.to_bytes([self.__Address, 0x03, 0x01, 0x4A, 0x00, 0x03, int(crc_Tx[3:],16), int(crc_Tx[1:3],16)]))</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    </div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        <span class="comment">#There is a delay caused by the converter. The program must wait before reading the result</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        sleep(0.02)</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    </div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        <span class="comment">#Receive data</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        GPIO.output(self.__Control, GPIO.LOW)</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        cnt = 0</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        data_left = ser.inWaiting()</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        <span class="keywordflow">while</span> (data_left == 0):</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            <span class="comment">#wait for data</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            cnt=cnt+1</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            <span class="keywordflow">if</span> (cnt &lt; 50000): <span class="comment">#wait for maximum 5 seconds</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                sleep(0.0001)</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                data_left = ser.inWaiting()</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                print(<span class="stringliteral">&quot;Transmitting error: Time out&quot;</span>)</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                <span class="keywordflow">return</span> Trans_error</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        received_data = ser.read()</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        sleep(0.02)</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        data_left = ser.inWaiting()</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        received_data += ser.read(data_left)</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        </div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <span class="keywordflow">if</span> ((received_data[0]) != self.__Address):</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Data corrupted&quot;</span>)</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            <span class="keywordflow">return</span> Data_error</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <span class="keywordflow">if</span> (len(received_data) != 11):</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Data corrupted&quot;</span>)</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            <span class="keywordflow">return</span> Data_error</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        </div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        <span class="comment">#Check the CRC code</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        crc_cal = hex(crc16(received_data[:9]))</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        crc_Rx = hex(struct.unpack(<span class="stringliteral">&#39;H&#39;</span>,received_data[9:])[0])</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    </div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <span class="keywordflow">if</span> crc_cal == crc_Rx:</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            self.__PF1 = float(struct.unpack(<span class="stringliteral">&#39;h&#39;</span>, received_data[4:2:-1])[0])/1000</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            self.__PF2 = float(struct.unpack(<span class="stringliteral">&#39;h&#39;</span>, received_data[6:4:-1])[0])/1000</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            self.__PF3 = float(struct.unpack(<span class="stringliteral">&#39;h&#39;</span>, received_data[8:6:-1])[0])/1000    </div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            <span class="keywordflow">return</span> No_error</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Incorrect CRC&quot;</span>)</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            <span class="keywordflow">return</span> CRC_error </div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;   </div></div><!-- fragment -->
</div>
</div>
<a id="a452c39aafd6a6091eb4a6d1f96cfc159"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a452c39aafd6a6091eb4a6d1f96cfc159">&#9670;&nbsp;</a></span>readPT1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def MIC3.MIC1.readPT1 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads PT1 variable needed for all other calculations. </p>

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00276">276</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">References <a class="el" href="_m_i_c3_8py_source.html#l00028">MIC3.MIC2.__Address</a>, <a class="el" href="_m_i_c3_8py_source.html#l00251">MIC3.MIC1.__Address</a>, <a class="el" href="_m_i_c3_8py_source.html#l00027">MIC3.MIC2.__Control</a>, <a class="el" href="_m_i_c3_8py_source.html#l00250">MIC3.MIC1.__Control</a>, and <a class="el" href="_m_i_c3_8py_source.html#l00252">MIC3.MIC1.__PT1</a>.</p>
<div class="fragment"><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keyword">def </span>readPT1(self):</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="comment">#Calculate CRC16-MODBUS</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        crc16 = crcmod.mkCrcFun(0x18005, rev=<span class="keyword">True</span>, initCrc = 0xFFFF, xorOut = 0x0000)</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        crc_Tx = <span class="stringliteral">&quot;.%4x&quot;</span>%(crc16(serial.to_bytes([self.__Address, 0x03, 0x01, 0x05, 0x00, 0x02])))</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="comment">#The crc_Tx must include 4 hexadecimal characters.</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="comment">#If crc_Tx =  10, function hex() will return 0xa, which is not expected</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="comment">#Therefore, String format operator was used</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    </div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="comment">#Send request</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        GPIO.output(self.__Control, GPIO.HIGH)</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        ser.write(serial.to_bytes([self.__Address, 0x03, 0x01, 0x05, 0x00, 0x02, int(crc_Tx[3:],16), int(crc_Tx[1:3],16)]))</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    </div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="comment">#There is a delay caused by the converter. The program must wait before reading the result</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        sleep(0.01)</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    </div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="comment">#Receive data</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        GPIO.output(self.__Control, GPIO.LOW)</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        cnt = 0</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        data_left = ser.inWaiting()</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordflow">while</span> (data_left == 0):</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <span class="comment">#wait for data</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            cnt=cnt+1</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <span class="keywordflow">if</span> (cnt &lt; 50000): <span class="comment">#wait for maximum 5 seconds</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                sleep(0.0001)</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                data_left = ser.inWaiting()</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                print(<span class="stringliteral">&quot;Transmitting error: Time out&quot;</span>)</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                <span class="keywordflow">return</span> Trans_error</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    </div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        received_data = ser.read()</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        sleep(0.01)</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        data_left = ser.inWaiting()</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        received_data += ser.read(data_left)</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        </div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="comment">#Check if the data is correct</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">if</span> ((received_data[0]) != self.__Address):</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Data corrupted&quot;</span>)</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <span class="keywordflow">return</span> Data_error</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordflow">if</span> (len(received_data) != 9):</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Data corrupted&quot;</span>)</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            <span class="keywordflow">return</span> Data_error</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        </div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="comment">#Check the CRC code</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        crc_cal = hex(crc16(received_data[:7]))</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="comment">#DEBUG ONLY-----------------------------------------------</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="comment">#retval = &quot;&quot;</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="comment">#for character in received_data:</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="comment">#    retval += (&#39;0123456789ABCDEF&#39;[int((character)/16)])</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="comment">#    retval += (&#39;0123456789ABCDEF&#39;[int((character)%16)])</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="comment">#    retval += &#39;:&#39;</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="comment">#print (retval[:-1])</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="comment">#print (crc_cal) #use for debugging only</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="comment">#---------------------------------------------------------</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    </div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        crc_Rx = hex(struct.unpack(<span class="stringliteral">&#39;H&#39;</span>,received_data[7:])[0])</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    </div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="comment">#print (crc_Rx) #use for degugging only</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    </div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="keywordflow">if</span> crc_cal == crc_Rx:</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            self.__PT1 = float(struct.unpack(<span class="stringliteral">&#39;I&#39;</span>, received_data[6:2:-1])[0])</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <span class="keywordflow">return</span> No_error</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Incorrect CRC&quot;</span>)</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            <span class="keywordflow">return</span> CRC_error</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    </div></div><!-- fragment -->
</div>
</div>
<a id="a965d6b2d1f557741c6361814f7b7be3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a965d6b2d1f557741c6361814f7b7be3f">&#9670;&nbsp;</a></span>readPT2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def MIC3.MIC1.readPT2 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads PT2 variable needed for all other calculations. </p>

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00343">343</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">References <a class="el" href="_m_i_c3_8py_source.html#l00028">MIC3.MIC2.__Address</a>, <a class="el" href="_m_i_c3_8py_source.html#l00251">MIC3.MIC1.__Address</a>, <a class="el" href="_m_i_c3_8py_source.html#l00027">MIC3.MIC2.__Control</a>, <a class="el" href="_m_i_c3_8py_source.html#l00250">MIC3.MIC1.__Control</a>, and <a class="el" href="_m_i_c3_8py_source.html#l00253">MIC3.MIC1.__PT2</a>.</p>
<div class="fragment"><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keyword">def </span>readPT2(self):</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="comment">#Calculate CRC16-MODBUS</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        crc16 = crcmod.mkCrcFun(0x18005, rev=<span class="keyword">True</span>, initCrc = 0xFFFF, xorOut = 0x0000)</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        crc_Tx = <span class="stringliteral">&quot;.%4x&quot;</span>%(crc16(serial.to_bytes([self.__Address, 0x03, 0x01, 0x07, 0x00, 0x01])))</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="comment">#The crc_Tx must include 4 hexadecimal characters.</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="comment">#If crc_Tx =  10, function hex() will return 0xa, which is not expected</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="comment">#Therefore, String format operator was used</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    </div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="comment">#Send request</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        GPIO.output(self.__Control, GPIO.HIGH)</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        ser.write(serial.to_bytes([self.__Address, 0x03, 0x01, 0x07, 0x00, 0x01, int(crc_Tx[3:],16), int(crc_Tx[1:3],16)]))</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    </div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="comment">#There is a delay caused by the converter. The program must wait before reading the result</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        sleep(0.01)</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    </div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="comment">#Receive data</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        GPIO.output(self.__Control, GPIO.LOW)</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        cnt = 0</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        data_left = ser.inWaiting()</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordflow">while</span> (data_left == 0):</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            <span class="comment">#wait for data</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            cnt=cnt+1</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            <span class="keywordflow">if</span> (cnt &lt; 50000): <span class="comment">#wait for maximum 5 seconds</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                sleep(0.0001)</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                data_left = ser.inWaiting()</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                print(<span class="stringliteral">&quot;Transmitting error: Time out&quot;</span>)</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                <span class="keywordflow">return</span> Trans_error</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    </div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        received_data = ser.read()</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        sleep(0.01)</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        data_left = ser.inWaiting()</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        received_data += ser.read(data_left)</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        </div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="comment">#Check if the data is correct</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="keywordflow">if</span> ((received_data[0]) != self.__Address):</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Data corrupted&quot;</span>)</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <span class="keywordflow">return</span> Data_error</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="keywordflow">if</span> (len(received_data) != 7):</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Data corrupted&quot;</span>)</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            <span class="keywordflow">return</span> Data_error</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        </div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <span class="comment">#Check the CRC code</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        crc_cal = hex(crc16(received_data[:5]))</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="comment">#DEBUG ONLY-----------------------------------------------</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="comment">#retval = &quot;&quot;</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="comment">#for character in received_data:</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="comment">#    retval += (&#39;0123456789ABCDEF&#39;[int((character)/16)])</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="comment">#    retval += (&#39;0123456789ABCDEF&#39;[int((character)%16)])</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="comment">#    retval += &#39;:&#39;</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="comment">#print (retval[:-1])</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="comment">#print (crc_cal) #use for debugging only</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="comment">#---------------------------------------------------------</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    </div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        crc_Rx = hex(struct.unpack(<span class="stringliteral">&#39;H&#39;</span>,received_data[5:])[0])</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    </div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="comment">#print (crc_Rx) #use for degugging only</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    </div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="keywordflow">if</span> crc_cal == crc_Rx:</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            self.__PT2 = float(struct.unpack(<span class="stringliteral">&#39;H&#39;</span>, received_data[4:2:-1])[0])</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            <span class="keywordflow">return</span> No_error</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Incorrect CRC&quot;</span>)</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            <span class="keywordflow">return</span> CRC_error</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            </div></div><!-- fragment -->
</div>
</div>
<a id="a8d7c0913d3999f6f7737d6ffc56383a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d7c0913d3999f6f7737d6ffc56383a3">&#9670;&nbsp;</a></span>readReactivePower()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def MIC3.MIC1.readReactivePower </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads and calculates Reactive Power (Q) values with the help of PT1, PT2, CT1. </p>

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00654">654</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">References <a class="el" href="_m_i_c3_8py_source.html#l00028">MIC3.MIC2.__Address</a>, <a class="el" href="_m_i_c3_8py_source.html#l00251">MIC3.MIC1.__Address</a>, <a class="el" href="_m_i_c3_8py_source.html#l00027">MIC3.MIC2.__Control</a>, <a class="el" href="_m_i_c3_8py_source.html#l00250">MIC3.MIC1.__Control</a>, <a class="el" href="_m_i_c3_8py_source.html#l00254">MIC3.MIC1.__CT1</a>, <a class="el" href="_m_i_c3_8py_source.html#l00252">MIC3.MIC1.__PT1</a>, <a class="el" href="_m_i_c3_8py_source.html#l00253">MIC3.MIC1.__PT2</a>, <a class="el" href="_m_i_c3_8py_source.html#l00264">MIC3.MIC1.__Q1</a>, <a class="el" href="_m_i_c3_8py_source.html#l00265">MIC3.MIC1.__Q2</a>, and <a class="el" href="_m_i_c3_8py_source.html#l00266">MIC3.MIC1.__Q3</a>.</p>
<div class="fragment"><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keyword">def </span>readReactivePower(self):</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <span class="comment">#Calculate CRC16-MODBUS</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        crc16 = crcmod.mkCrcFun(0x18005, rev=<span class="keyword">True</span>, initCrc = 0xFFFF, xorOut = 0x0000)</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        crc_Tx = <span class="stringliteral">&quot;.%4x&quot;</span>%(crc16(serial.to_bytes([self.__Address, 0x03, 0x01, 0x42, 0x00, 0x03])))</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        <span class="comment">#The crc_Tx must include 4 hexadecimal characters.</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="comment">#If crc_Tx =  10, function hex() will return 0xa, which is not expected</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="comment">#Therefore, String format operator was used</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    </div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <span class="comment">#Send request</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        GPIO.output(self.__Control, GPIO.HIGH)</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        ser.write(serial.to_bytes([self.__Address, 0x03, 0x01, 0x42, 0x00, 0x03, int(crc_Tx[3:],16), int(crc_Tx[1:3],16)]))</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    </div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <span class="comment">#There is a delay caused by the converter. The program must wait before reading the result</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        sleep(0.02)</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    </div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <span class="comment">#Receive data</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        GPIO.output(self.__Control, GPIO.LOW)</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        cnt = 0</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        data_left = ser.inWaiting()</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <span class="keywordflow">while</span> (data_left == 0):</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            <span class="comment">#wait for data</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            cnt=cnt+1</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;            <span class="keywordflow">if</span> (cnt &lt; 50000): <span class="comment">#wait for maximum 5 seconds</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                sleep(0.0001)</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                data_left = ser.inWaiting()</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                print(<span class="stringliteral">&quot;Transmitting error: Time out&quot;</span>)</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                <span class="keywordflow">return</span> Trans_error</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        received_data = ser.read()</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        sleep(0.02)</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        data_left = ser.inWaiting()</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        received_data += ser.read(data_left)</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        </div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="keywordflow">if</span> ((received_data[0]) != self.__Address):</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Data corrupted&quot;</span>)</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            <span class="keywordflow">return</span> Data_error</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        <span class="keywordflow">if</span> (len(received_data) != 11):</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Data corrupted&quot;</span>)</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            <span class="keywordflow">return</span> Data_error</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        </div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        <span class="comment">#Check the CRC code</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        crc_cal = hex(crc16(received_data[:9]))</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        crc_Rx = hex(struct.unpack(<span class="stringliteral">&#39;H&#39;</span>,received_data[9:])[0])</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    </div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <span class="keywordflow">if</span> crc_cal == crc_Rx:</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            self.__Q1 = float(struct.unpack(<span class="stringliteral">&#39;h&#39;</span>, received_data[4:2:-1])[0])*(self.__PT1/self.__PT2)*(self.__CT1/5)</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            self.__Q2 = float(struct.unpack(<span class="stringliteral">&#39;h&#39;</span>, received_data[6:4:-1])[0])*(self.__PT1/self.__PT2)*(self.__CT1/5)</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            self.__Q3 = float(struct.unpack(<span class="stringliteral">&#39;h&#39;</span>, received_data[8:6:-1])[0])*(self.__PT1/self.__PT2)*(self.__CT1/5)    </div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            <span class="keywordflow">return</span> No_error</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;            print(<span class="stringliteral">&quot;Transmitting error: Incorrect CRC&quot;</span>)</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;            <span class="keywordflow">return</span> CRC_error</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        </div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a41c7912044a1237fba1a97e5c3ce7af1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41c7912044a1237fba1a97e5c3ce7af1">&#9670;&nbsp;</a></span>__Address</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MIC3.MIC1.__Address</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00251">251</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="_m_i_c3_8py_source.html#l00709">MIC3.MIC1.readApparentPower()</a>, <a class="el" href="_m_i_c3_8py_source.html#l00410">MIC3.MIC1.readCT1()</a>, <a class="el" href="_m_i_c3_8py_source.html#l00818">MIC3.MIC1.readFrequency()</a>, <a class="el" href="_m_i_c3_8py_source.html#l00546">MIC3.MIC1.readPhaseCurrent()</a>, <a class="el" href="_m_i_c3_8py_source.html#l00600">MIC3.MIC1.readPhasePower()</a>, <a class="el" href="_m_i_c3_8py_source.html#l00477">MIC3.MIC1.readPhaseVoltage()</a>, <a class="el" href="_m_i_c3_8py_source.html#l00764">MIC3.MIC1.readPowerFactor()</a>, <a class="el" href="_m_i_c3_8py_source.html#l00276">MIC3.MIC1.readPT1()</a>, <a class="el" href="_m_i_c3_8py_source.html#l00343">MIC3.MIC1.readPT2()</a>, and <a class="el" href="_m_i_c3_8py_source.html#l00654">MIC3.MIC1.readReactivePower()</a>.</p>

</div>
</div>
<a id="a925ca2e301860fe9aa378350534b161f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a925ca2e301860fe9aa378350534b161f">&#9670;&nbsp;</a></span>__Control</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MIC3.MIC1.__Control</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00250">250</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="_m_i_c3_8py_source.html#l00709">MIC3.MIC1.readApparentPower()</a>, <a class="el" href="_m_i_c3_8py_source.html#l00410">MIC3.MIC1.readCT1()</a>, <a class="el" href="_m_i_c3_8py_source.html#l00818">MIC3.MIC1.readFrequency()</a>, <a class="el" href="_m_i_c3_8py_source.html#l00546">MIC3.MIC1.readPhaseCurrent()</a>, <a class="el" href="_m_i_c3_8py_source.html#l00600">MIC3.MIC1.readPhasePower()</a>, <a class="el" href="_m_i_c3_8py_source.html#l00477">MIC3.MIC1.readPhaseVoltage()</a>, <a class="el" href="_m_i_c3_8py_source.html#l00764">MIC3.MIC1.readPowerFactor()</a>, <a class="el" href="_m_i_c3_8py_source.html#l00276">MIC3.MIC1.readPT1()</a>, <a class="el" href="_m_i_c3_8py_source.html#l00343">MIC3.MIC1.readPT2()</a>, and <a class="el" href="_m_i_c3_8py_source.html#l00654">MIC3.MIC1.readReactivePower()</a>.</p>

</div>
</div>
<a id="aaa1e6791e5fb9881e4c0bb7fdba94a1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa1e6791e5fb9881e4c0bb7fdba94a1f">&#9670;&nbsp;</a></span>__CT1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MIC3.MIC1.__CT1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00254">254</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="_m_i_c3_8py_source.html#l00709">MIC3.MIC1.readApparentPower()</a>, <a class="el" href="_m_i_c3_8py_source.html#l00410">MIC3.MIC1.readCT1()</a>, <a class="el" href="_m_i_c3_8py_source.html#l00546">MIC3.MIC1.readPhaseCurrent()</a>, <a class="el" href="_m_i_c3_8py_source.html#l00600">MIC3.MIC1.readPhasePower()</a>, and <a class="el" href="_m_i_c3_8py_source.html#l00654">MIC3.MIC1.readReactivePower()</a>.</p>

</div>
</div>
<a id="ac24e1bb43a234d3545bd9dea897ee7f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac24e1bb43a234d3545bd9dea897ee7f8">&#9670;&nbsp;</a></span>__F</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MIC3.MIC1.__F</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00273">273</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="_m_i_c3_8py_source.html#l00818">MIC3.MIC1.readFrequency()</a>.</p>

</div>
</div>
<a id="aa9c7409f828f138464d9a3993b5f963e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9c7409f828f138464d9a3993b5f963e">&#9670;&nbsp;</a></span>__I1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MIC3.MIC1.__I1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00258">258</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="_m_i_c3_8py_source.html#l00546">MIC3.MIC1.readPhaseCurrent()</a>.</p>

</div>
</div>
<a id="a17b42cbaf99e99320ef96d929239cf44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17b42cbaf99e99320ef96d929239cf44">&#9670;&nbsp;</a></span>__I2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MIC3.MIC1.__I2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00259">259</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="_m_i_c3_8py_source.html#l00546">MIC3.MIC1.readPhaseCurrent()</a>.</p>

</div>
</div>
<a id="ada54499b12ef8714e2e359d69a5a9a37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada54499b12ef8714e2e359d69a5a9a37">&#9670;&nbsp;</a></span>__I3</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MIC3.MIC1.__I3</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00260">260</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="_m_i_c3_8py_source.html#l00546">MIC3.MIC1.readPhaseCurrent()</a>.</p>

</div>
</div>
<a id="ad9d7c288a2f535a91f01fdb7f688f9cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9d7c288a2f535a91f01fdb7f688f9cc">&#9670;&nbsp;</a></span>__P1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MIC3.MIC1.__P1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00261">261</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="_m_i_c3_8py_source.html#l00600">MIC3.MIC1.readPhasePower()</a>.</p>

</div>
</div>
<a id="ac4bbfbf696790ea59be3e8153089107e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4bbfbf696790ea59be3e8153089107e">&#9670;&nbsp;</a></span>__P2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MIC3.MIC1.__P2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00262">262</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="_m_i_c3_8py_source.html#l00600">MIC3.MIC1.readPhasePower()</a>.</p>

</div>
</div>
<a id="a584aaa23ae37f473e718ac005c95be6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a584aaa23ae37f473e718ac005c95be6e">&#9670;&nbsp;</a></span>__P3</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MIC3.MIC1.__P3</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00263">263</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="_m_i_c3_8py_source.html#l00600">MIC3.MIC1.readPhasePower()</a>.</p>

</div>
</div>
<a id="a2eb1458e0c349707753186002063859b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2eb1458e0c349707753186002063859b">&#9670;&nbsp;</a></span>__PF1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MIC3.MIC1.__PF1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00270">270</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="_m_i_c3_8py_source.html#l00764">MIC3.MIC1.readPowerFactor()</a>.</p>

</div>
</div>
<a id="a6bd93a47ffd2e1440f00ea82e1b26f65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bd93a47ffd2e1440f00ea82e1b26f65">&#9670;&nbsp;</a></span>__PF2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MIC3.MIC1.__PF2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00271">271</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="_m_i_c3_8py_source.html#l00764">MIC3.MIC1.readPowerFactor()</a>.</p>

</div>
</div>
<a id="a0cedb48c21b85171b2f8f316afa59a85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cedb48c21b85171b2f8f316afa59a85">&#9670;&nbsp;</a></span>__PF3</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MIC3.MIC1.__PF3</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00272">272</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="_m_i_c3_8py_source.html#l00764">MIC3.MIC1.readPowerFactor()</a>.</p>

</div>
</div>
<a id="a0202879a9a20c6db9fab96bf2bc2665a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0202879a9a20c6db9fab96bf2bc2665a">&#9670;&nbsp;</a></span>__PT1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MIC3.MIC1.__PT1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00252">252</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="_m_i_c3_8py_source.html#l00709">MIC3.MIC1.readApparentPower()</a>, <a class="el" href="_m_i_c3_8py_source.html#l00600">MIC3.MIC1.readPhasePower()</a>, <a class="el" href="_m_i_c3_8py_source.html#l00477">MIC3.MIC1.readPhaseVoltage()</a>, <a class="el" href="_m_i_c3_8py_source.html#l00276">MIC3.MIC1.readPT1()</a>, and <a class="el" href="_m_i_c3_8py_source.html#l00654">MIC3.MIC1.readReactivePower()</a>.</p>

</div>
</div>
<a id="a27404fde06ca91ba97fed1afe1305a4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27404fde06ca91ba97fed1afe1305a4c">&#9670;&nbsp;</a></span>__PT2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MIC3.MIC1.__PT2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00253">253</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="_m_i_c3_8py_source.html#l00709">MIC3.MIC1.readApparentPower()</a>, <a class="el" href="_m_i_c3_8py_source.html#l00600">MIC3.MIC1.readPhasePower()</a>, <a class="el" href="_m_i_c3_8py_source.html#l00477">MIC3.MIC1.readPhaseVoltage()</a>, <a class="el" href="_m_i_c3_8py_source.html#l00343">MIC3.MIC1.readPT2()</a>, and <a class="el" href="_m_i_c3_8py_source.html#l00654">MIC3.MIC1.readReactivePower()</a>.</p>

</div>
</div>
<a id="accfdf53475991f816e00e89be6011df5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accfdf53475991f816e00e89be6011df5">&#9670;&nbsp;</a></span>__Q1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MIC3.MIC1.__Q1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00264">264</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="_m_i_c3_8py_source.html#l00654">MIC3.MIC1.readReactivePower()</a>.</p>

</div>
</div>
<a id="aa52fd24601379190142365d2e94ed3bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa52fd24601379190142365d2e94ed3bc">&#9670;&nbsp;</a></span>__Q2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MIC3.MIC1.__Q2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00265">265</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="_m_i_c3_8py_source.html#l00654">MIC3.MIC1.readReactivePower()</a>.</p>

</div>
</div>
<a id="afcffecd5fd8a2b410326e3d5ba79c78e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcffecd5fd8a2b410326e3d5ba79c78e">&#9670;&nbsp;</a></span>__Q3</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MIC3.MIC1.__Q3</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00266">266</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="_m_i_c3_8py_source.html#l00654">MIC3.MIC1.readReactivePower()</a>.</p>

</div>
</div>
<a id="a6bcbbf706089333c946aa4965af8e656"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bcbbf706089333c946aa4965af8e656">&#9670;&nbsp;</a></span>__S1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MIC3.MIC1.__S1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00267">267</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="_m_i_c3_8py_source.html#l00709">MIC3.MIC1.readApparentPower()</a>.</p>

</div>
</div>
<a id="ab89d273cd8a7d1f0fe67a701e9e54f82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab89d273cd8a7d1f0fe67a701e9e54f82">&#9670;&nbsp;</a></span>__S2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MIC3.MIC1.__S2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00268">268</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="_m_i_c3_8py_source.html#l00709">MIC3.MIC1.readApparentPower()</a>.</p>

</div>
</div>
<a id="af5f14575962daa8e627bc9fdf673b253"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5f14575962daa8e627bc9fdf673b253">&#9670;&nbsp;</a></span>__S3</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MIC3.MIC1.__S3</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00269">269</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="_m_i_c3_8py_source.html#l00709">MIC3.MIC1.readApparentPower()</a>.</p>

</div>
</div>
<a id="a808ae0455f68a6e35d5cf646f2ed5bed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a808ae0455f68a6e35d5cf646f2ed5bed">&#9670;&nbsp;</a></span>__V1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MIC3.MIC1.__V1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00255">255</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="_m_i_c3_8py_source.html#l00477">MIC3.MIC1.readPhaseVoltage()</a>.</p>

</div>
</div>
<a id="aa931212b1077630e0d00a7521b9ba7ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa931212b1077630e0d00a7521b9ba7ef">&#9670;&nbsp;</a></span>__V2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MIC3.MIC1.__V2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00256">256</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="_m_i_c3_8py_source.html#l00477">MIC3.MIC1.readPhaseVoltage()</a>.</p>

</div>
</div>
<a id="ac14c988b04364214b6846226e31d7416"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac14c988b04364214b6846226e31d7416">&#9670;&nbsp;</a></span>__V3</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MIC3.MIC1.__V3</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_m_i_c3_8py_source.html#l00257">257</a> of file <a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="_m_i_c3_8py_source.html#l00477">MIC3.MIC1.readPhaseVoltage()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>Modbus/<a class="el" href="_m_i_c3_8py_source.html">MIC3.py</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespace_m_i_c3.html">MIC3</a></li><li class="navelem"><a class="el" href="class_m_i_c3_1_1_m_i_c1.html">MIC1</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
